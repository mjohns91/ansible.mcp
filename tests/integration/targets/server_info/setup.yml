---
- hosts: localhost
  gather_facts: true

  vars:
    ansible_mcp_hosts:
      - name: github_server
        server_name: github-server
        bearer_token: "{{ github_mcp_pat }}"
        manifest_path: "{{ playbook_dir }}/manifest.json"
      - name: aws_iam_server
        server_name: aws-iam-mcp-server
        server_args:
          - --readonly
        server_env:
          AWS_REGION: "{{ aws_region }}"
          AWS_ACCESS_KEY_ID: "{{ aws_access_key }}"
          AWS_SECRET_ACCESS_KEY: "{{ aws_secret_key }}"
          AWS_SESSION_TOKEN: "{{ security_token }}"
        manifest_path: "{{ playbook_dir }}/manifest.json"
    ansible_mcp_inventory_file_path: "{{ playbook_dir }}/inventory.yml"

  roles:
    - role: prepare_inventory
